<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Approche par fenêtres glissantes | BayPass 2.4: tutoriel de génomique d’association adapté au séquençage en pool</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Approche par fenêtres glissantes | BayPass 2.4: tutoriel de génomique d’association adapté au séquençage en pool" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://jolivares-inrae.github.io/BayPass_Tutorial/C:/Users/Olivares/Documents/R/Git_Work/BayPass_Tutorial/cover.jpg" />
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="https://github.com/Jolivares-INRAE/BayPass_Tutorial" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Approche par fenêtres glissantes | BayPass 2.4: tutoriel de génomique d’association adapté au séquençage en pool" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="twitter:image" content="https://jolivares-inrae.github.io/BayPass_Tutorial/C:/Users/Olivares/Documents/R/Git_Work/BayPass_Tutorial/cover.jpg" />

<meta name="author" content="Jérôme OLIVARES" />


<meta name="date" content="2023-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="les-résultats-de-contraste-c2.html"/>
<link rel="next" href="annexes.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
\usepackage{booktabs}


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Résumé</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#mots-clefs"><i class="fa fa-check"></i>mots clefs</a></li>
<li class="chapter" data-level="" data-path="prérequis.html"><a href="prérequis.html"><i class="fa fa-check"></i>prérequis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="présentation-du-logiciel-baypass-2.html"><a href="présentation-du-logiciel-baypass-2.html"><i class="fa fa-check"></i>Présentation du logiciel BayPass 2.3</a>
<ul>
<li class="chapter" data-level="" data-path="présentation-générale-de-lanalyse.html"><a href="présentation-générale-de-lanalyse.html"><i class="fa fa-check"></i>Présentation générale de l’analyse :</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="données-brutes.html"><a href="données-brutes.html"><i class="fa fa-check"></i>Données brutes</a>
<ul>
<li class="chapter" data-level="" data-path="obtention-dun-fichier-poolseq.html"><a href="obtention-dun-fichier-poolseq.html"><i class="fa fa-check"></i>Obtention d’un fichier Poolseq.vcf :</a></li>
<li class="chapter" data-level="" data-path="filtrage-des-données-brutes.html"><a href="filtrage-des-données-brutes.html"><i class="fa fa-check"></i>Filtrage des données brutes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html"><a href="conversion-du-pooldata-en-fichiers-dentrées-pour-baypass.html"><i class="fa fa-check"></i>Conversion du pooldata en fichiers d’entrées pour BayPass</a>
<ul>
<li class="chapter" data-level="" data-path="design-de-lanalyse-baypass.html"><a href="design-de-lanalyse-baypass.html"><i class="fa fa-check"></i>Design de l’analyse BayPass</a></li>
<li class="chapter" data-level="" data-path="subsampling.html"><a href="subsampling.html"><i class="fa fa-check"></i>Subsampling</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="baypass-lanalyse-poolseq.html"><a href="baypass-lanalyse-poolseq.html"><i class="fa fa-check"></i>Baypass : l’analyse poolseq</a></li>
<li class="chapter" data-level="" data-path="baypass-les-résultats.html"><a href="baypass-les-résultats.html"><i class="fa fa-check"></i>Baypass : les résultats</a>
<ul>
<li class="chapter" data-level="" data-path="validation-des-données-analysées.html"><a href="validation-des-données-analysées.html"><i class="fa fa-check"></i>Validation des données analysées</a></li>
<li class="chapter" data-level="" data-path="concaténation-des-résultats.html"><a href="concaténation-des-résultats.html"><i class="fa fa-check"></i>Concaténation des résultats</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exploitation-des-résultats.html"><a href="exploitation-des-résultats.html"><i class="fa fa-check"></i>Exploitation des résultats</a>
<ul>
<li class="chapter" data-level="" data-path="les-résultats-de-différentiation-xtx.html"><a href="les-résultats-de-différentiation-xtx.html"><i class="fa fa-check"></i>Les résultats de différentiation <em>XtX</em>:</a></li>
<li class="chapter" data-level="" data-path="les-résultats-de-bayes-factor-bf.html"><a href="les-résultats-de-bayes-factor-bf.html"><i class="fa fa-check"></i>Les résultats de Bayes Factor <em>BF</em>:</a></li>
<li class="chapter" data-level="" data-path="les-résultats-de-contraste-c2.html"><a href="les-résultats-de-contraste-c2.html"><i class="fa fa-check"></i>Les résultats de Contraste <em>C2</em>:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="approche-par-fenêtres-glissantes.html"><a href="approche-par-fenêtres-glissantes.html"><i class="fa fa-check"></i>Approche par fenêtres glissantes</a></li>
<li class="chapter" data-level="" data-path="annexes.html"><a href="annexes.html"><i class="fa fa-check"></i>Annexes</a>
<ul>
<li class="chapter" data-level="" data-path="An1.html"><a href="An1.html"><i class="fa fa-check"></i>Annexe 1</a>
<ul>
<li class="chapter" data-level="" data-path="An1.html"><a href="An1.html#fst-en-fenêtre-glissante"><i class="fa fa-check"></i>Fst en fenêtre glissante</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="An2.html"><a href="An2.html"><i class="fa fa-check"></i>Annexe 2</a>
<ul>
<li class="chapter" data-level="" data-path="An2.html"><a href="An2.html#conversion-de-la-matrice-svd-en-graphique-ggplot"><i class="fa fa-check"></i>Conversion de la matrice SVD en graphique ggplot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="An3.html"><a href="An3.html"><i class="fa fa-check"></i>Annexe 3</a>
<ul>
<li class="chapter" data-level="" data-path="An3.html"><a href="An3.html#concaténages-des-résultats-betai-et-contrastes"><i class="fa fa-check"></i>Concaténages des résultats Betai et contrastes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="An4.html"><a href="An4.html"><i class="fa fa-check"></i>Annexe 4</a>
<ul>
<li class="chapter" data-level="" data-path="An4.html"><a href="An4.html#création-et-analyse-dun-jeu-de-données-pseudo-observées-pod"><i class="fa fa-check"></i>Création et analyse d’un jeu de données pseudo-observées (POD)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="références.html"><a href="références.html"><i class="fa fa-check"></i>Références</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BayPass 2.4: tutoriel de génomique d’association adapté au séquençage en pool</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="approche-par-fenêtres-glissantes" class="section level1 unnumbered hasAnchor">
<h1>Approche par fenêtres glissantes<a href="approche-par-fenêtres-glissantes.html#approche-par-fenêtres-glissantes" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Dans l’approche par fenêtre glissante, une fenêtre de longueur spécifiée se déplace sur les données, en se décalant d’un pas défini. A chaque glissement le nombre de données contenu dans la fenêtre est calculé. La fonction <em>Fenetres_glissantes.R</em> permet de faire ce calcul (Chunk <a href="approche-par-fenêtres-glissantes.html#exr:chunk11">11</a>), à partir d’une table contenant au minimum les colonnes <em>chr</em> et <em>pos</em>, en sortie, le nombre de valeurs contenues dans chaque fenêtre est reporté dans une colonne <em>nValues</em> et la position de chaque fenêtre est définie par les colonnes <em>Start</em> et <em>End</em>. Ce type de représentation permet de visualiser les régions génomiques qui sont concentrées en SNP sélectionnés sur la base d’une statistique d’intérêt. Cette approche est particulièrement intéressante quand les signatures de sélections sont faibles.</p>
<div class="exercise">
<p><span id="exr:chunk11" class="exercise"><strong>Chunk 11  </strong></span><span style="color:darkgreen">Visualisation par fenêtres glissantes.</span></p>
</div>
<p style="font-family: calibri; font-size:11pt; font-style:italic; color:darkgreen">
Deux paramètres sont à renseigner: la taille de la fenêtre et le pas de glissement.<br>
Une fois la fonction exécutée le résultat peut être visualisé par un plot (pos, nValues) de chaque chromosome<br>
</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb28-1"><a href="approche-par-fenêtres-glissantes.html#cb28-1" tabindex="-1"></a><span class="co">#travail sur le top 1% des XtX.</span></span>
<span id="cb28-2"><a href="approche-par-fenêtres-glissantes.html#cb28-2" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">subset</span>(Full.res, M_XtX <span class="sc">&gt;</span> <span class="fu">quantile</span>(Full.res<span class="sc">$</span>M_XtX, <span class="at">probs=</span><span class="fl">0.99</span> ))</span>
<span id="cb28-3"><a href="approche-par-fenêtres-glissantes.html#cb28-3" tabindex="-1"></a>slide_x <span class="ot">&lt;-</span> <span class="fu">sliding_window_counts</span>(df, <span class="at">window_size =</span> <span class="dv">50000</span>, <span class="at">step_size =</span> <span class="dv">5000</span>)</span>
<span id="cb28-4"><a href="approche-par-fenêtres-glissantes.html#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="approche-par-fenêtres-glissantes.html#cb28-5" tabindex="-1"></a><span class="co">#plot de la concentration du top 1% des XtX</span></span>
<span id="cb28-6"><a href="approche-par-fenêtres-glissantes.html#cb28-6" tabindex="-1"></a>Manplot.SX <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data=</span>slide_x, <span class="fu">aes</span>(<span class="at">x=</span>Start, <span class="at">y=</span>nValues)) <span class="sc">+</span></span>
<span id="cb28-7"><a href="approche-par-fenêtres-glissantes.html#cb28-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>chr), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="approche-par-fenêtres-glissantes.html#cb28-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb28-9"><a href="approche-par-fenêtres-glissantes.html#cb28-9" tabindex="-1"></a>Manplot.SX <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Plot du nombre de XtX dans le top 1% par fenêtres de 50Kb&quot;</span>)<span class="sc">+</span></span>
<span id="cb28-10"><a href="approche-par-fenêtres-glissantes.html#cb28-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>chr, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>, <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="BayPass_Fr_files/figure-html/plot_slide_BF-1.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb29-1"><a href="approche-par-fenêtres-glissantes.html#cb29-1" tabindex="-1"></a><span class="co">#travail sur les Bayes Factors &gt;= 15</span></span>
<span id="cb29-2"><a href="approche-par-fenêtres-glissantes.html#cb29-2" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">subset</span>(Full.res, BF.dB. <span class="sc">&gt;=</span> <span class="dv">15</span>)</span>
<span id="cb29-3"><a href="approche-par-fenêtres-glissantes.html#cb29-3" tabindex="-1"></a>slide_bf <span class="ot">&lt;-</span> <span class="fu">sliding_window_counts</span>(df, <span class="at">window_size =</span> <span class="dv">50000</span>, <span class="at">step_size =</span> <span class="dv">5000</span>)</span>
<span id="cb29-4"><a href="approche-par-fenêtres-glissantes.html#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="approche-par-fenêtres-glissantes.html#cb29-5" tabindex="-1"></a><span class="co">#plot de la concentration en BF &gt;= 15</span></span>
<span id="cb29-6"><a href="approche-par-fenêtres-glissantes.html#cb29-6" tabindex="-1"></a>Manplot.SBF <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data=</span>slide_bf, <span class="fu">aes</span>(<span class="at">x=</span>Start, <span class="at">y=</span>nValues)) <span class="sc">+</span></span>
<span id="cb29-7"><a href="approche-par-fenêtres-glissantes.html#cb29-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>chr), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb29-8"><a href="approche-par-fenêtres-glissantes.html#cb29-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb29-9"><a href="approche-par-fenêtres-glissantes.html#cb29-9" tabindex="-1"></a>Manplot.SBF <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Plot du nombre de Bayes Factors &gt;= 15 par fenêtres de 50Kb&quot;</span>)<span class="sc">+</span></span>
<span id="cb29-10"><a href="approche-par-fenêtres-glissantes.html#cb29-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>chr, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>, <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="BayPass_Fr_files/figure-html/plot_slide_BF-2.png" width="672" /></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb30-1"><a href="approche-par-fenêtres-glissantes.html#cb30-1" tabindex="-1"></a><span class="co">#travail sur le top 1% des contrastes</span></span>
<span id="cb30-2"><a href="approche-par-fenêtres-glissantes.html#cb30-2" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">subset</span>(Full.res, M_C2 <span class="sc">&gt;</span> <span class="fu">quantile</span>(Full.res<span class="sc">$</span>M_C2, <span class="at">probs=</span><span class="fl">0.99</span> ))</span>
<span id="cb30-3"><a href="approche-par-fenêtres-glissantes.html#cb30-3" tabindex="-1"></a>slide_C2 <span class="ot">&lt;-</span> <span class="fu">sliding_window_counts</span>(df, <span class="at">window_size =</span> <span class="dv">50000</span>, <span class="at">step_size =</span> <span class="dv">5000</span>)</span>
<span id="cb30-4"><a href="approche-par-fenêtres-glissantes.html#cb30-4" tabindex="-1"></a></span>
<span id="cb30-5"><a href="approche-par-fenêtres-glissantes.html#cb30-5" tabindex="-1"></a><span class="co">#plot de la concentration du top 1% des C2</span></span>
<span id="cb30-6"><a href="approche-par-fenêtres-glissantes.html#cb30-6" tabindex="-1"></a>Manplot.SC2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data=</span>slide_C2, <span class="fu">aes</span>(<span class="at">x=</span>Start, <span class="at">y=</span>nValues)) <span class="sc">+</span></span>
<span id="cb30-7"><a href="approche-par-fenêtres-glissantes.html#cb30-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>chr), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="approche-par-fenêtres-glissantes.html#cb30-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb30-9"><a href="approche-par-fenêtres-glissantes.html#cb30-9" tabindex="-1"></a>Manplot.SC2 <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Plot du nombre de contraste C2 dans le top 1% par fenêtres de 50Kb&quot;</span>)<span class="sc">+</span></span>
<span id="cb30-10"><a href="approche-par-fenêtres-glissantes.html#cb30-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>chr, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>, <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>))</span></code></pre></div>
<p><img src="BayPass_Fr_files/figure-html/plot_slide_BF-3.png" width="672" /></p>
<p>Dans l’exemple précédent les fenêtres glissantes permettent de mettre en évidence</p>
<p>#Comparaison par diagramme de Venn:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb31-1"><a href="approche-par-fenêtres-glissantes.html#cb31-1" tabindex="-1"></a><span class="co">#Filtrage selon conditions</span></span>
<span id="cb31-2"><a href="approche-par-fenêtres-glissantes.html#cb31-2" tabindex="-1"></a>Datmp1 <span class="ot">=</span> <span class="fu">subset</span>(Full.res, M_XtX <span class="sc">&gt;</span> <span class="fu">quantile</span>(Full.res<span class="sc">$</span>M_XtX, <span class="at">probs=</span><span class="fl">0.99</span> ))</span>
<span id="cb31-3"><a href="approche-par-fenêtres-glissantes.html#cb31-3" tabindex="-1"></a>Datmp2 <span class="ot">=</span> <span class="fu">subset</span>(Full.res, BF.dB.<span class="sc">&gt;=</span> <span class="dv">15</span>)</span>
<span id="cb31-4"><a href="approche-par-fenêtres-glissantes.html#cb31-4" tabindex="-1"></a>Datmp3 <span class="ot">=</span> <span class="fu">subset</span>(Full.res, log10.<span class="fl">1.</span>pval. <span class="sc">&gt;</span><span class="fu">quantile</span>(Full.res<span class="sc">$</span>log10.<span class="fl">1.</span>pval., <span class="at">probs=</span><span class="fl">0.99</span>))</span>
<span id="cb31-5"><a href="approche-par-fenêtres-glissantes.html#cb31-5" tabindex="-1"></a></span>
<span id="cb31-6"><a href="approche-par-fenêtres-glissantes.html#cb31-6" tabindex="-1"></a><span class="co">#Conversion en liste au format &quot;chr1_pos1, chr1_pos2, chr1_pos3, ...&quot;, </span></span>
<span id="cb31-7"><a href="approche-par-fenêtres-glissantes.html#cb31-7" tabindex="-1"></a>List.SNP1<span class="ot">&lt;-</span><span class="fu">paste</span>(Datmp1[,<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>, Datmp1[,<span class="dv">2</span>], <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb31-8"><a href="approche-par-fenêtres-glissantes.html#cb31-8" tabindex="-1"></a>List.SNP2<span class="ot">&lt;-</span><span class="fu">paste</span>(Datmp2[,<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>, Datmp2[,<span class="dv">2</span>], <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb31-9"><a href="approche-par-fenêtres-glissantes.html#cb31-9" tabindex="-1"></a>List.SNP3<span class="ot">&lt;-</span><span class="fu">paste</span>(Datmp3[,<span class="dv">1</span>], <span class="st">&quot;_&quot;</span>, Datmp3[,<span class="dv">2</span>], <span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb32-1"><a href="approche-par-fenêtres-glissantes.html#cb32-1" tabindex="-1"></a><span class="co">#Diagramme de Venn</span></span>
<span id="cb32-2"><a href="approche-par-fenêtres-glissantes.html#cb32-2" tabindex="-1"></a>v.list<span class="ot">=</span><span class="fu">list</span>(<span class="st">&quot;BF &gt;=15&quot;</span> <span class="ot">=</span> List.SNP2, <span class="st">&quot;XtX (top1%)&quot;</span> <span class="ot">=</span> List.SNP1, <span class="st">&quot;log10.1.pval. (top 1%)&quot;</span> <span class="ot">=</span> List.SNP3)</span>
<span id="cb32-3"><a href="approche-par-fenêtres-glissantes.html#cb32-3" tabindex="-1"></a>vd0 <span class="ot">&lt;-</span> <span class="fu">venn.diagram</span>(v.list, <span class="at">fill =</span> <span class="fu">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;pink&quot;</span>,<span class="st">&quot;lightblue&quot;</span>), <span class="at">cat.col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">fontface =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">filename =</span> <span class="cn">NULL</span>)</span>
<span id="cb32-4"><a href="approche-par-fenêtres-glissantes.html#cb32-4" tabindex="-1"></a><span class="fu">grid.newpage</span>()</span>
<span id="cb32-5"><a href="approche-par-fenêtres-glissantes.html#cb32-5" tabindex="-1"></a><span class="fu">grid.draw</span>(vd0)</span></code></pre></div>
<p><img src="BayPass_Fr_files/figure-html/venn-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb33-1"><a href="approche-par-fenêtres-glissantes.html#cb33-1" tabindex="-1"></a>v.table<span class="ot">&lt;-</span><span class="fu">get.venn.partitions</span>(v.list, <span class="at">keep.elements =</span> <span class="cn">TRUE</span>, <span class="at">hierarchical =</span> <span class="cn">TRUE</span>)<span class="sc">%&gt;%</span> <span class="co">#extrait les tables des intersects</span></span>
<span id="cb33-2"><a href="approche-par-fenêtres-glissantes.html#cb33-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">&quot;..set..&quot;</span>, <span class="st">&quot;..values..&quot;</span>) <span class="sc">%&gt;%</span> <span class="co">#ne garde que les colonnes set (nom de l&#39;intersect) et values (liste des éléments de l&#39;intersect)</span></span>
<span id="cb33-3"><a href="approche-par-fenêtres-glissantes.html#cb33-3" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> <span class="st">&quot;..set..&quot;</span>, <span class="at">value =</span> <span class="st">&quot;..values..&quot;</span>)<span class="sc">%&gt;%</span> <span class="co">#réorganiser les données en 2 colonnes distinctes </span></span>
<span id="cb33-4"><a href="approche-par-fenêtres-glissantes.html#cb33-4" tabindex="-1"></a>  <span class="fu">rename_all</span>(<span class="sc">~</span> <span class="fu">gsub</span>(<span class="st">&quot;∩&quot;</span>, <span class="st">&quot; &amp; &quot;</span>, <span class="fu">gsub</span>(<span class="st">&quot;∖.*$&quot;</span>, <span class="st">&quot;&quot;</span>, .)))<span class="sc">%&gt;%</span>  <span class="co">#remplace le symbole &quot;∩&quot;, par &quot; &amp; &quot; et supprime tout ce qui est après &quot;∖&quot;</span></span>
<span id="cb33-5"><a href="approche-par-fenêtres-glissantes.html#cb33-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">&quot;intersect&quot;</span>) <span class="sc">%&gt;%</span>  <span class="co">#transpose/pivote les colonnes</span></span>
<span id="cb33-6"><a href="approche-par-fenêtres-glissantes.html#cb33-6" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> value)<span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="approche-par-fenêtres-glissantes.html#cb33-7" tabindex="-1"></a>  <span class="fu">separate</span>(value, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;pos&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="approche-par-fenêtres-glissantes.html#cb33-8" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">c</span>(<span class="dv">3</span>), as.numeric)</span>
<span id="cb33-9"><a href="approche-par-fenêtres-glissantes.html#cb33-9" tabindex="-1"></a></span>
<span id="cb33-10"><a href="approche-par-fenêtres-glissantes.html#cb33-10" tabindex="-1"></a></span>
<span id="cb33-11"><a href="approche-par-fenêtres-glissantes.html#cb33-11" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Les noms et les effectifs des intersects du diagramme de Venn sont :&quot;</span>,</span>
<span id="cb33-12"><a href="approche-par-fenêtres-glissantes.html#cb33-12" tabindex="-1"></a>    <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="fu">paste0</span>(<span class="fu">names</span>(<span class="fu">table</span>(v.table<span class="sc">$</span>intersect)),</span>
<span id="cb33-13"><a href="approche-par-fenêtres-glissantes.html#cb33-13" tabindex="-1"></a>                 <span class="st">&quot; n=&quot;</span>, <span class="fu">table</span>(v.table<span class="sc">$</span>intersect)), <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre class="bg-output"><code>## Les noms et les effectifs des intersects du diagramme de Venn sont :
## 
## 
## (BF &gt;=15 &amp; XtX (top1%)) n=55
## (BF &gt;=15) n=721
## (log10.1.pval. (top 1%)) n=3112
## (XtX (top1%) &amp; log10.1.pval. (top 1%)) n=7040
## (XtX (top1%)) n=3057
## BF &gt;=15 &amp; XtX (top1%) &amp; log10.1.pval. (top 1%) n=263</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb35-1"><a href="approche-par-fenêtres-glissantes.html#cb35-1" tabindex="-1"></a><span class="co"># # créé une table avec  une colonne par intersect et les items en dessous</span></span>
<span id="cb35-2"><a href="approche-par-fenêtres-glissantes.html#cb35-2" tabindex="-1"></a><span class="co"># test&lt;-get.venn.partitions(v.list, keep.elements = TRUE, hierarchical = TRUE)%&gt;% #extrait les tables des intersects</span></span>
<span id="cb35-3"><a href="approche-par-fenêtres-glissantes.html#cb35-3" tabindex="-1"></a><span class="co">#   select(&quot;..set..&quot;, &quot;..values..&quot;) %&gt;% #ne garde que les colonnes set (nom de l&#39;intersect) et values (liste des éléments de l&#39;intersect)</span></span>
<span id="cb35-4"><a href="approche-par-fenêtres-glissantes.html#cb35-4" tabindex="-1"></a><span class="co">#   spread(key = &quot;..set..&quot;, value = &quot;..values..&quot;)%&gt;% #réorganiser les données en 2 colonnes distinctes</span></span>
<span id="cb35-5"><a href="approche-par-fenêtres-glissantes.html#cb35-5" tabindex="-1"></a><span class="co">#   rename_all(~ gsub(&quot;∩&quot;, &quot; &amp; &quot;, .))%&gt;%  #remplace le symbole &quot;∩&quot;, par &quot; &amp; &quot; dans les noms d&#39;intersects</span></span>
<span id="cb35-6"><a href="approche-par-fenêtres-glissantes.html#cb35-6" tabindex="-1"></a><span class="co">#   rename_all(~ gsub(&quot;∖.*$&quot;, &quot;&quot;, .))%&gt;%</span></span>
<span id="cb35-7"><a href="approche-par-fenêtres-glissantes.html#cb35-7" tabindex="-1"></a><span class="co">#   pivot_longer(cols = everything(), names_to = &quot;intersect&quot;) %&gt;%  #transpose/pivote les colonnes</span></span>
<span id="cb35-8"><a href="approche-par-fenêtres-glissantes.html#cb35-8" tabindex="-1"></a><span class="co">#   unnest(cols = value)%&gt;% #déploie les éléments de la colonne values</span></span>
<span id="cb35-9"><a href="approche-par-fenêtres-glissantes.html#cb35-9" tabindex="-1"></a><span class="co">#   group_by(intersect) %&gt;%  #groupe les données par la colonne &quot;name&quot;</span></span>
<span id="cb35-10"><a href="approche-par-fenêtres-glissantes.html#cb35-10" tabindex="-1"></a><span class="co">#   mutate(row_id = row_number()) %&gt;% #ajoute une nouvelle colonne &quot;row_id&quot; qui contient le numéro de ligne de chaque groupe.</span></span>
<span id="cb35-11"><a href="approche-par-fenêtres-glissantes.html#cb35-11" tabindex="-1"></a><span class="co">#   pivot_wider(names_from = intersect, values_from = value) %&gt;% #remet les données avec les valeurs de chaque groupe &quot;name&quot; dans des colonnes séparées</span></span>
<span id="cb35-12"><a href="approche-par-fenêtres-glissantes.html#cb35-12" tabindex="-1"></a><span class="co">#   select(-row_id)</span></span>
<span id="cb35-13"><a href="approche-par-fenêtres-glissantes.html#cb35-13" tabindex="-1"></a></span>
<span id="cb35-14"><a href="approche-par-fenêtres-glissantes.html#cb35-14" tabindex="-1"></a><span class="co">#write.table(test, row.names = FALSE, file=paste(path_res, &quot;venn.txt&quot;, sep=&quot;&quot;), quote = FALSE, sep = &quot;\t&quot;)</span></span></code></pre></div>
<p>#Convertir les liste de SNP dans un intersecte en fichier bed</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r bg-chunk"><code class="sourceCode r"><span id="cb36-1"><a href="approche-par-fenêtres-glissantes.html#cb36-1" tabindex="-1"></a><span class="co">#subset en fonction de l&#39;intersecte que l&#39;on veut</span></span>
<span id="cb36-2"><a href="approche-par-fenêtres-glissantes.html#cb36-2" tabindex="-1"></a>sub.venn<span class="ot">&lt;-</span>v.table<span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="approche-par-fenêtres-glissantes.html#cb36-3" tabindex="-1"></a>  <span class="fu">filter</span>(intersect <span class="sc">==</span> <span class="st">&quot;BF &gt;=15 &amp; XtX (top1%) &amp; log10.1.pval. (top 1%)&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="approche-par-fenêtres-glissantes.html#cb36-4" tabindex="-1"></a>  <span class="fu">left_join</span>(Full.res, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;chr&quot;</span>, <span class="st">&quot;pos&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="approche-par-fenêtres-glissantes.html#cb36-5" tabindex="-1"></a>  <span class="fu">select</span>(chr,pos,M_XtX,BF.dB.)</span>
<span id="cb36-6"><a href="approche-par-fenêtres-glissantes.html#cb36-6" tabindex="-1"></a></span>
<span id="cb36-7"><a href="approche-par-fenêtres-glissantes.html#cb36-7" tabindex="-1"></a><span class="co">#plot de la concentration du top 1% des C2</span></span>
<span id="cb36-8"><a href="approche-par-fenêtres-glissantes.html#cb36-8" tabindex="-1"></a>Manplot.venn <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data=</span>sub.venn, <span class="fu">aes</span>(<span class="at">x=</span>pos, <span class="at">y=</span>BF.dB.)) <span class="sc">+</span></span>
<span id="cb36-9"><a href="approche-par-fenêtres-glissantes.html#cb36-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>chr), <span class="at">alpha=</span><span class="fl">0.8</span>, <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb36-10"><a href="approche-par-fenêtres-glissantes.html#cb36-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.ticks.x=</span><span class="fu">element_blank</span>())</span>
<span id="cb36-11"><a href="approche-par-fenêtres-glissantes.html#cb36-11" tabindex="-1"></a>Manplot.venn <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Plot du nombre de contraste C2 dans le top 1% par fenêtres de 50Kb&quot;</span>)<span class="sc">+</span></span>
<span id="cb36-12"><a href="approche-par-fenêtres-glissantes.html#cb36-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>chr, <span class="at">scales =</span> <span class="st">&#39;free_x&#39;</span>, <span class="at">strip.position =</span> <span class="fu">c</span>(<span class="st">&quot;bottom&quot;</span>))</span>
<span id="cb36-13"><a href="approche-par-fenêtres-glissantes.html#cb36-13" tabindex="-1"></a></span>
<span id="cb36-14"><a href="approche-par-fenêtres-glissantes.html#cb36-14" tabindex="-1"></a><span class="co">#Conversion de la table en fichier .bed</span></span>
<span id="cb36-15"><a href="approche-par-fenêtres-glissantes.html#cb36-15" tabindex="-1"></a>sub.bed<span class="ot">&lt;-</span>v.table<span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="approche-par-fenêtres-glissantes.html#cb36-16" tabindex="-1"></a>  <span class="fu">filter</span>(intersect <span class="sc">==</span> <span class="st">&quot;BF &gt;=15 &amp; XtX (top1%) &amp; log10.1.pval. (top 1%)&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="approche-par-fenêtres-glissantes.html#cb36-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Start =</span> pos <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="approche-par-fenêtres-glissantes.html#cb36-18" tabindex="-1"></a>  <span class="fu">select</span>(chr, Start, pos)<span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="approche-par-fenêtres-glissantes.html#cb36-19" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">End =</span> pos)</span>
<span id="cb36-20"><a href="approche-par-fenêtres-glissantes.html#cb36-20" tabindex="-1"></a><span class="co">#write.table(sub.bed, file=paste0(path_res, &quot;Intersect_SNP.bed&quot;, sep=&quot;&quot;), quote = FALSE, sep = &quot;\t&quot;, row.names = FALSE)</span></span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="les-résultats-de-contraste-c2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="annexes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
